<% if policy(Favorite.new).create? %>
<div class="favorite">
  <% if favorite = current_user.favorited(trail) %>
    <%= link_to [trail, favorite], class: 'btn btn-danger btn-xs', method: :delete do %>
      <i class="glyphicon glyphicon-star-empty"> </i>&nbsp; Unfavorite
    <% end %>
  <% else %>
    <%= link_to [trail, Favorite.new], class: 'btn btn-primary btn-xs', method: :post do %>
      <i class="glyphicon glyphicon-star"> </i>&nbsp; Favorite
      <% end %>
  <% end %>
</div>
<% end %>